title: 二级协议
---

## 说明：

1.波特率 9600 N 8 1

2.校验方式 加总异或

3.数据格式 固定帧头+长度+数据区+校验。
①长度为数据区长度 [设备地址,数据结束]。
②校验为数据区加总异或 [设备地址,数据结束]。

4.数据模式 大端模式 高位在前，低位在后。

5.数据连续主动上报最小时间间隔200ms。

6.所有主动上报指令必须等待接收到入网成功指令后再上报。

## 握手

### 设备发送

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖0D
`设备地址` | 0✖00
`命令类型` | 0✖69
`起始地址` | 0✖00 0✖66
`寄存器数量` | 0✖00 0✖04
`字节数` | 0✖06
`设备类型` | 0✖01
`子类型` | 0✖01
`软件版本` | 0✖** 0✖**
`硬件版本` | 0✖** 0✖**
`校验` | 0✖**

### 模块回复

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖06
`设备地址` | 0✖00
`命令类型` | 0✖69
`起始地址` | 0✖00 0✖04
`校验` | 0✖**

{% note info 提示 %}
设备上电接收到入网成功指令后，主动发送握手指令 。
{% endnote %}

## 入网

### 设备发送

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖06
`设备地址` | 0✖00
`命令类型` | 0✖66
`寄存器地址` | 0✖00 0✖86
`寄存器值` | 0✖00 0✖01
`校验` | 0✖**

### 模块回复

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖04
`设备地址` | 0✖00
`命令类型` | 0✖66
`寄存器地址` | 0✖00 0✖86
`校验` | 0✖**

## 退网

### 设备发送

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖06
`设备地址` | 0✖00
`命令类型` | 0✖66
`寄存器地址` | 0✖00 0✖87
`寄存器值` | 0✖00 0✖01
`校验` | 0✖**

### 模块回复

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖04
`设备地址` | 0✖00
`命令类型` | 0✖66
`寄存器地址` | 0✖00 0✖87
`校验` | 0✖**

## 复位

### 设备发送

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖06
`设备地址` | 0✖00
`命令类型` | 0✖66
`寄存器地址` | 0✖00 0✖85
`寄存器值` | 0✖00 0✖01
`校验` | 0✖**

### 模块回复

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖04
`设备地址` | 0✖00
`命令类型` | 0✖66
`寄存器地址` | 0✖00 0✖85
`校验` | 0✖**

{% note info 提示 %}
1.设备快速连按3次入网，指示灯闪烁/蜂鸣器鸣响时间间隔500ms ，收到回复后停止，超时60S，成功快速闪烁三次，熄灭；失败长亮3S，熄灭。
2.设备快速连按4次退网，指示灯长亮3S/蜂鸣器长响3S
3.3次心跳无回复发送一条复位指令。
4.复位地址变更为0x85
{% endnote %}

## 心跳

### 设备发送

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖06
`设备地址` | 0✖00
`命令类型` | 0✖80
`寄存器地址` | 0✖00 0✖88
`寄存器值` | 0✖00 0✖**
`校验` | 0✖**

### 模块回复

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖04
`设备地址` | 0✖00
`命令类型` | 0✖80
`寄存器地址` | 0✖00 0✖88
`校验` | 0✖**

{% note info 提示 %}
设备每隔10分钟发送一次心跳包，1S内没有回复，重发2次，无回复，则发送复位。
{% endnote %}

## 控制

### 打开

#### 设备发送

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖06
`设备地址` | 0✖00
`命令类型` | 0✖06
`寄存器地址` | 0✖00 0✖01
`寄存器值` | 0✖00 0✖01
`校验` | 0✖**

#### 模块回复

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖04
`设备地址` | 0✖00
`命令类型` | 0✖06
`寄存器地址` | 0✖00 0✖01
`校验` | 0✖**

### 关闭

#### 设备发送

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖06
`设备地址` | 0✖00
`命令类型` | 0✖06
`寄存器地址` | 0✖00 0✖02
`寄存器值` | 0✖00 0✖01
`校验` | 0✖**

#### 模块回复

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖04
`设备地址` | 0✖00
`命令类型` | 0✖06
`寄存器地址` | 0✖00 0✖02
`校验` | 0✖**

### 暂停

#### 设备发送

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖06
`设备地址` | 0✖00
`命令类型` | 0✖06
`寄存器地址` | 0✖00 0✖03
`寄存器值` | 0✖00 0✖01
`校验` | 0✖**

#### 模块回复

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖04
`设备地址` | 0✖00
`命令类型` | 0✖06
`寄存器地址` | 0✖00 0✖03
`校验` | 0✖**

### 百分比

#### 设备发送

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖06
`设备地址` | 0✖00
`命令类型` | 0✖06
`寄存器地址` | 0✖00 0✖04
`寄存器值` | 0✖00 0✖**
`校验` | 0✖**

#### 模块回复

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖04
`设备地址` | 0✖00
`命令类型` | 0✖06
`寄存器地址` | 0✖00 0✖04
`校验` | 0✖**

## 设置

### 反向

#### 设备发送

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖06
`设备地址` | 0✖00
`命令类型` | 0✖06
`寄存器地址` | 0✖00 0✖11
`寄存器值` | 0✖00 0✖01
`校验` | 0✖**

#### 模块回复

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖04
`设备地址` | 0✖00
`命令类型` | 0✖06
`寄存器地址` | 0✖00 0✖11
`校验` | 0✖**

### 速度

#### 设备发送

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖06
`设备地址` | 0✖00
`命令类型` | 0✖06
`寄存器地址` | 0✖00 0✖12
`寄存器值` | 0✖00 0✖**
`校验` | 0✖**

#### 模块回复

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖04
`设备地址` | 0✖00
`命令类型` | 0✖06
`寄存器地址` | 0✖00 0✖12
`校验` | 0✖**

### 上电自动开关

#### 设备发送

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖06
`设备地址` | 0✖00
`命令类型` | 0✖06
`寄存器地址` | 0✖00 0✖13
`寄存器值` | 0✖00 0✖**
`校验` | 0✖**

#### 模块回复

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖04
`设备地址` | 0✖00
`命令类型` | 0✖06
`寄存器地址` | 0✖00 0✖13
`校验` | 0✖**

## 命令

### 恢复出厂设置

#### 设备发送

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖06
`设备地址` | 0✖00
`命令类型` | 0✖06
`寄存器地址` | 0✖00 0✖21
`寄存器值` | 0✖00 0✖01
`校验` | 0✖**

#### 模块回复

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖04
`设备地址` | 0✖00
`命令类型` | 0✖06
`寄存器地址` | 0✖00 0✖21
`校验` | 0✖**

### 复位

#### 设备发送

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖06
`设备地址` | 0✖00
`命令类型` | 0✖06
`寄存器地址` | 0✖00 0✖22
`寄存器值` | 0✖00 0✖01
`校验` | 0✖**

#### 模块回复

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖04
`设备地址` | 0✖00
`命令类型` | 0✖06
`寄存器地址` | 0✖00 0✖22
`校验` | 0✖**

{% note info 提示 %}
若无断电行程记忆，设备默认执行上电自动开关，上电后先开后关，最后回到最初位置（用户最后一次操作停止的位置，不一定在两端）。上电时（百分比为0xFF）和完成行程记忆时主动上报百分比、换向、速度等级，每条时间间隔200ms，参考主动上报格式。
{% endnote %}

## 读取

### 设备发送

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖06
`设备地址` | 0✖00
`命令类型` | 0✖03
`起始地址` | 0✖00 0✖**
`寄存器数量` | 0✖00 0✖**
`校验` | 0✖**

### 模块回复

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖**
`设备地址` | 0✖00
`命令类型` | 0✖03
`起始地址` | 0✖00 0✖**
`寄存器数量` | 0✖00 0✖**
`字节长度` | 0✖**
`数据1高位` | 0✖00
`数据1低位` | 0✖**
`校验` | 0✖**

{% note info 提示 %}
1、查询寄存器地址的值，内容包含百分比和设置参数。
2、字节长度决定了后的数据，例如：字节长度为4，后面数据依次为数据 1H 1L 2H 2L
{% endnote %}

## 主动上报

### 设备发送

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖06
`设备地址` | 0✖00
`命令类型` | 0✖04
`寄存器地址` | 0✖00 0✖**
`寄存器值` | 0✖00 0✖**
`校验` | 0✖**

### 模块回复

项 | 值
--- | ---
`帧头` | 0✖5A 0✖A5
`长度` | 0✖04
`设备地址` | 0✖00
`命令类型` | 0✖04
`寄存器地址` | 0✖00 0✖**
`校验` | 0✖**

{% note info 提示 %}
1.设置发生变化时，主动上报
2.状态发生改变时上报当前状态 打开/关闭
3.窗帘停止时上报当前百分比
4.所有上报数据确保每条上报成功，1S内未回复，重新上报，最多上报三次
{% endnote %}






